
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_tutorials\plot_svd.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_tutorials_plot_svd.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_tutorials_plot_svd.py:


Conpute SVD
====================

.. GENERATED FROM PYTHON SOURCE LINES 8-12

.. code-block:: default

    import pycartool as cart
    import numpy as np
    import matplotlib.pyplot as plt








.. GENERATED FROM PYTHON SOURCE LINES 13-14

#### Import  from Cartool files

.. GENERATED FROM PYTHON SOURCE LINES 16-22

.. code-block:: default

    fname_spi = 'MNI152.NlinAsym09c.204.5000.2017.spi'
    fname_roi = 'MNI152.NlinAsym09c.204.5000.2017.AAL.rois'

    spi = cart.source_space.read_spi(fname_spi)
    roi = cart.regions_of_interest.read_roi(fname_roi, spi)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    RO01
    Dimension_of_original_data: 5004
    Number of ROI: 114




.. GENERATED FROM PYTHON SOURCE LINES 23-24

#### Constants

.. GENERATED FROM PYTHON SOURCE LINES 26-31

.. code-block:: default

    sfreq = 512
    n_sources = len(spi.names)
    snr = 10
    n_times = 2048








.. GENERATED FROM PYTHON SOURCE LINES 32-33

### Simulate sources time course

.. GENERATED FROM PYTHON SOURCE LINES 35-36

Here we simulate the sources time course as random noise generators everywhere in the brain, expect in the first Region of interest where sources time course are simulated are sin waves in the x direction.

.. GENERATED FROM PYTHON SOURCE LINES 38-39

#### Create random noise

.. GENERATED FROM PYTHON SOURCE LINES 41-43

.. code-block:: default

    simulated_tc = np.random.normal(size=(n_sources, 3, n_times))








.. GENERATED FROM PYTHON SOURCE LINES 44-49

.. code-block:: default

    plt.figure()
    plt.plot(simulated_tc[0,0], color='navy')
    plt.title('Time course of a source outside the first Roi')
    plt.show()




.. image-sg:: /auto_tutorials/images/sphx_glr_plot_svd_001.png
   :alt: Time course of a source outside the first Roi
   :srcset: /auto_tutorials/images/sphx_glr_plot_svd_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 50-51

#### Create sin wave in Roi

.. GENERATED FROM PYTHON SOURCE LINES 53-56

.. code-block:: default

    x = np.arange(0,n_times,1)
    sin = snr * np.sin(x/(2 * np.pi))








.. GENERATED FROM PYTHON SOURCE LINES 57-62

.. code-block:: default

    for elem in roi.groups_of_indexes[0]:
        simulated_tc[elem][0] = sin
        simulated_tc[elem][1] = np.zeros(sin.shape)
        simulated_tc[elem][2] = np.zeros(sin.shape)








.. GENERATED FROM PYTHON SOURCE LINES 63-68

.. code-block:: default

    plt.figure()
    plt.plot(sin, color ='red')
    plt.title('Time course of sources inside the first Roi  (x direction)')
    plt.show()




.. image-sg:: /auto_tutorials/images/sphx_glr_plot_svd_002.png
   :alt: Time course of sources inside the first Roi  (x direction)
   :srcset: /auto_tutorials/images/sphx_glr_plot_svd_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 69-71

.. code-block:: default

    source_estimate_simulated = cart.source_estimate.SourceEstimate(simulated_tc, sfreq=sfreq, source_space=spi)








.. GENERATED FROM PYTHON SOURCE LINES 72-73

#### Compute the regions of interest time course

.. GENERATED FROM PYTHON SOURCE LINES 75-77

.. code-block:: default

    roi_t_simulated = source_estimate_simulated.compute_rois_tc(roi)








.. GENERATED FROM PYTHON SOURCE LINES 78-83

.. code-block:: default

    plt.figure()
    plt.plot(roi_t_simulated.sources_tc[0:4,0,:].T)
    plt.title('Rois time course')
    plt.show()




.. image-sg:: /auto_tutorials/images/sphx_glr_plot_svd_003.png
   :alt: Rois time course
   :srcset: /auto_tutorials/images/sphx_glr_plot_svd_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  7.238 seconds)


.. _sphx_glr_download_auto_tutorials_plot_svd.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_svd.py <plot_svd.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_svd.ipynb <plot_svd.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
